import{q as C,R as f,r as b,t as F,a as e,j as i}from"./app-d2a3d537.js";import{B as I,J as x}from"./Api-80eca046.js";import{g as S,f as m,n as r}from"./Helper-e1a63998.js";import{g as R,a as v,p as K,b as M}from"./Request-a7bce2e9.js";import{A as q}from"./AdminLayout-90b2035a.js";import{b as A,p as D}from"./MedicalCheckup-84b76896.js";import E from"./PatientInformation-caca90f6.js";import{u as G,a as H}from"./app-fb271a11.js";import{T as _}from"./TextInput-21fcf679.js";import{P as g}from"./Pill-07fbc269.js";import{P as J}from"./PrimaryButton-c4bee480.js";import{T as h}from"./Toast-3fee0a06.js";import{R as u}from"./ResponseMessages-5367e22c.js";import{B as L}from"./ButtonLink-1059a812.js";import"./ThemeButton-138f6990.js";import"./Button-6a81ea58.js";import"./index.esm-2b0f1775.js";import"./Popover-43033a57.js";import"./ClearButton-f395bb26.js";import"./index.es-302dcb1a.js";import"./ApplicationLogo-7624da29.js";import"./CheckupRecord-2fa0f175.js";import"./Registration-c85af660.js";import"./Doctor-8ebd7b82.js";import"./Clinic-f89fd43c.js";import"./VisitType-0f2b0c06.js";import"./Patient-e8af8ff9.js";import"./HealthWorker-225f8e62.js";import"./Certificate-b20e9c29.js";import"./SlideSideBar-5ef5a5e3.js";import"./MedicalCheckupHIstoryList-4ad5539b.js";import"./TableDetail-31226791.js";import"./BorderedRoundedButton-600ca3a5.js";import"./NoData-9ab3477f.js";import"./MedicalCheckupHIstoryDetail-844fa362.js";function Pe(){const{theme:y}=G(),{bigFontColorTheme:l,borderedBottomTheme:d}=H(y),k=C(),w=S(k,"medical_checkup_id"),[s,$]=f(A),[t,o]=f(D),[T,O]=b.useState(!1),[V,p]=f(F),j=()=>{R(I+"/"+w,v()).then(a=>{a.status==200&&($(a.data.data._resources),P(a.data.data._resources),a.data.data._resources.payment&&o(a.data.data._resources.payment))}).catch(a=>{})},P=a=>{let n=0;if(a.medical_checkup_treatments)for(const c of a.medical_checkup_treatments)n+=parseFloat(c.amount);if(a.medical_checkup_items)for(const c of a.medical_checkup_items)n+=parseFloat(c.amount);if(a.medical_checkup_compounds)for(const c of a.medical_checkup_compounds)for(const N of c.medical_checkup_items)n+=parseFloat(N.amount);o({...t,amount:n})},B=()=>{t.id==0&&K(x,v(),{...t,medical_checkup:s}).then(a=>{a.status==201&&(o(a.data.data._resources),p({color:h.success,message:u.data_saved}))}).catch(a=>{p({color:h.danger,message:u.data_failed_to_save})}),t.id>0&&M(x+"/"+t.id,v(),{...t,medical_checkup:s}).then(a=>{a.status==200&&(o(a.data.data._resources),p({color:h.success,message:u.data_saved}))}).catch(a=>{p({color:h.danger,message:u.data_failed_to_save})})};return b.useEffect(()=>{j()},[]),e(q,{textName:"Kasir",breadCrumbItems:[{label:"Billing"},{label:"Kasir"}],children:s.id>0&&i("div",{className:"pt-4 pl-4 pr-4 mb-10 w-full",children:[e("div",{className:"w-full",children:e(E,{patient:s.checkup_record.registration.patient,registration:s.checkup_record.registration,showMMedicalCheckupHistory:!1})}),i("div",{className:"w-full xl:lg:w-1/2",children:[i("div",{className:"flex mt-2 justify-between",children:[e(g,{className:"bg-blue-600 h-6 text-white",children:s.doctor.name}),t.id>0?i(g,{className:"bg-green-600 h-6 text-white",children:["No. Bayar #",t.payment_number]}):null]}),i("div",{className:" text-sm",children:[i("div",{className:"mt-4",children:[e("div",{className:"flex",children:e("div",{className:`text-lg ${l} font-semibold`,children:"Tarif"})}),e("div",{className:"pl-12",children:s.medical_checkup_treatments.map((a,n)=>i("div",{className:`flex justify-between mb-3 pb-2 ${d}`,children:[e("div",{className:"",children:a.treatment.name}),e("div",{children:m(a.amount,!1)})]}))})]}),i("div",{className:"mt-6 text-sm",children:[e("div",{className:"flex",children:e("div",{className:`text-lg ${l} font-semibold`,children:"Obat"})}),e("div",{className:"pl-12",children:s.medical_checkup_items&&s.medical_checkup_items.filter(a=>a.item.item_type.id==1).map((a,n)=>i("div",{className:`flex justify-between mb-3 pb-2 ${d}`,children:[e("div",{className:"w-32",children:a.item.name}),e("div",{children:a.quantity}),e("div",{children:m(a.price_per_unit,!1)}),e("div",{children:m(a.amount,!1)})]}))})]}),i("div",{className:"mt-6 text-sm",children:[e("div",{className:"flex",children:e("div",{className:`text-lg ${l} font-semibold`,children:"Obat Racikan"})}),e("div",{className:"",children:s.medical_checkup_compounds&&s.medical_checkup_compounds.map((a,n)=>i("div",{children:[i("div",{className:`${l} mt-3`,children:["Racikan ",n+1]}),a.medical_checkup_items.map((c,N)=>i("div",{className:`ml-12 flex justify-between mb-3 pb-2 ${d}`,children:[e("div",{className:"w-32",children:c.item.name}),e("div",{children:c.quantity}),e("div",{children:m(c.price_per_unit,!1)}),e("div",{children:m(c.amount,!1)})]}))]}))}),i("div",{className:"ml-12",children:[e("span",{className:"text-xs",children:"Jasa Racik"}),e(_,{id:"name",type:"number",name:"name",value:t.compound_fee,className:" mt-1 block h-8 w-full text-right text-sm",onChange:a=>{o({...t,compound_fee:parseInt(a.target.value),change:parseInt(t.payment_amount)-(r(a.target.value)+parseFloat(t.amount)-r(t.discount))})}})]})]}),i("div",{className:"mt-6 text-sm",children:[e("div",{className:"flex",children:e("div",{className:`text-lg ${l} font-semibold`,children:"Bahan Habis Pakai"})}),e("div",{className:"pl-12",children:s.medical_checkup_items.filter(a=>a.item.item_type.id==2).map((a,n)=>i("div",{className:`flex justify-between mb-3 pb-2 ${d}`,children:[e("div",{className:"w-32",children:a.item.name}),e("div",{children:a.quantity}),e("div",{children:m(a.price_per_unit,!1)}),e("div",{children:m(a.amount,!1)})]}))})]}),i("div",{className:"mt-6 text-sm",children:[e("div",{className:"flex",children:e("div",{className:`text-lg ${l} font-semibold`,children:"Sub Total"})}),e("div",{className:"pl-12",children:i("div",{className:`flex justify-between mb-3 pb-2 ${d}`,children:[e("div",{className:"w-32",children:"Sub total"}),e("div",{children:m(parseFloat(t.amount)+r(t.compound_fee),!1)})]})})]}),i("div",{className:"mt-6 text-sm",children:[e("div",{className:"flex",children:e("div",{className:`text-lg ${l} font-semibold`,children:"Diskon"})}),i("div",{className:"ml-12",children:[e("span",{className:"text-xs",children:"Diskon"}),e(_,{id:"name",type:"number",name:"name",value:t.discount,className:" mt-1 block h-8 w-full text-right text-sm",onChange:a=>{o({...t,discount:parseInt(a.target.value),change:parseInt(t.payment_amount)-(r(t.compound_fee)+parseFloat(t.amount)-r(a.target.value))})}})]})]}),i("div",{className:"mt-6 text-sm",children:[e("div",{className:"flex",children:e("div",{className:`text-lg ${l} font-semibold`,children:"Grand Total"})}),e("div",{className:"pl-12",children:i("div",{className:`flex justify-between mb-3 pb-2 ${d}`,children:[e("div",{className:"w-32",children:"Grand total"}),e("div",{children:m(parseFloat(t.amount)+r(t.compound_fee)-r(t.discount),!1)})]})})]}),i("div",{className:"mt-6 text-sm",children:[e("div",{className:"flex",children:e("div",{className:`text-lg ${l} font-semibold`,children:"Bayar"})}),i("div",{className:"ml-12",children:[e("span",{className:"text-xs",children:"Bayar"}),e(_,{id:"name",type:"number",name:"name",value:t.payment_amount,className:" mt-1 block h-8 w-full text-right text-sm",onChange:a=>{o({...t,payment_amount:parseInt(a.target.value),change:parseInt(a.target.value)-(parseFloat(t.amount)+r(t.compound_fee)-r(t.discount))})}}),e("span",{className:`text-xs ${t.change<0?"text-red-600":""}`,children:t.change<0?"Kurang bayar":""})]})]}),i("div",{className:"mt-6 text-sm",children:[e("div",{className:"flex",children:e("div",{className:`text-lg ${l} font-semibold`,children:"Kembalian"})}),e("div",{className:"pl-12",children:i("div",{className:`flex justify-between mb-3 pb-2 ${d}`,children:[e("div",{className:"w-32",children:"Kembalian"}),e("div",{children:m(t.change,!1)})]})})]}),i("div",{className:"mt-4 flex justify-end",children:[e(L,{target:"_blank",className:"bg-blue-600 hover:bg-blue-400 mr-2",disabled:t.id==0,href:t.id>0?"/payment/print?medical_checkup_id="+s.id:"#",children:"Cetak"}),e(J,{className:"bg-green-500 hover:bg-green-400",disabled:T,onClick:B,children:"Simpan"})]})]})]})]})})}export{Pe as default};
