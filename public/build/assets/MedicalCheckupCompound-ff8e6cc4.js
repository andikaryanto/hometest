import{e as M,R as b,t as j,r as L,j as o,a as i}from"./app-d2a3d537.js";import{y,z as C}from"./Api-80eca046.js";import{p as w,a as _,d as $,b as q}from"./Request-a7bce2e9.js";import{u as B,a as E}from"./app-fb271a11.js";import{P as z}from"./PrimaryButton-c4bee480.js";import{T as x}from"./TextInput-21fcf679.js";import{d as T,k as S,l as D}from"./index.esm-2b0f1775.js";import{T as m}from"./Toast-3fee0a06.js";import{R as l}from"./ResponseMessages-5367e22c.js";import J from"./ItemListPopoverSearch-f8cb5ac6.js";import"./MedicalCheckup-84b76896.js";import"./MedicalCheckupFormGigi-385eedbe.js";import"./MedicalCheckupFormUmum-76e447aa.js";import{m as G}from"./MedicalCheckupItem-38b98507.js";import{C as u}from"./ClearButton-f395bb26.js";import"./Helper-e1a63998.js";import"./TableDetail-31226791.js";import"./BorderedRoundedButton-600ca3a5.js";import"./Button-6a81ea58.js";import"./NoData-9ab3477f.js";import"./PopoverInput-8f306410.js";import"./Pill-07fbc269.js";import"./Item-5a97d1bd.js";import"./Uom-6085d693.js";import"./ItemMargin-b56d4323.js";import"./CheckupRecord-2fa0f175.js";import"./Registration-c85af660.js";import"./Doctor-8ebd7b82.js";import"./Clinic-f89fd43c.js";import"./VisitType-0f2b0c06.js";import"./Patient-e8af8ff9.js";import"./HealthWorker-225f8e62.js";import"./Certificate-b20e9c29.js";const H={id:0,ordering:0,medical_checkup_items:[]},K=M({key:"medicalCheckupCompoundMedicineListState",default:[]});M({key:"medicalCheckupCompoundMedicinaState",default:H});function Re({title:Q,item:U,onSubmit:V,medicalCheckup:p,...W}){const{theme:A}=B(),{bigFontColorTheme:R}=E(A),[f,d]=b(K),[X,n]=b(j),O=()=>{w(y,_(),{medical_checkup:p,ordering:f.length+1}).then(a=>{a.status==201&&(d(t=>[...t,{...a.data.data._resources}]),n({color:m.success,message:l.data_saved}))}).catch(a=>{n({color:m.danger,message:l.data_failed_to_save})})},N=(a,t)=>{const e=t.medical_checkup_items?t.medical_checkup_items:[],s={...t,medical_checkup_items:[...e,G]};k(a,s)},F=(a,t)=>{t.id>0?$(y+"/"+t.id,_()).then(e=>{e.status==200&&(d(s=>s.filter((c,v)=>v!==a)),n({color:m.success,message:l.data_removed}))}).catch(e=>{n({color:m.danger,message:l.data_failed_to_save})}):d(e=>e.filter((r,c)=>c!==a))},k=(a,t)=>{d(e=>{const s=[...e];return s[a]=t,s})},g=(a,t,e,s,r)=>{s={...s,item:r};const c=[...e.medical_checkup_items];c[t]=s;const v={...e,medical_checkup_items:c};k(a,v)},P=(a,t,e,s)=>{s.id==0?w(C,_(),{...s,medical_checkup_compound:e}).then(r=>{if(r.status==201){const c=r.data.data._resources;g(a,t,e,c,c.item),n({color:m.success,message:l.data_saved})}}).catch(r=>{n({color:m.danger,message:l.data_failed_to_save})}):q(C+"/"+s.id,_(),{...s,medical_checkup_compound:e}).then(r=>{if(r.status==200){const c=r.data.data._resources;g(a,t,e,c,c.item),n({color:m.success,message:l.data_saved})}}).catch(r=>{n({color:m.danger,message:l.data_failed_to_save})})},h=(a,t,e,s,r)=>{s={...s,price_per_unit:r.price_per_unit,item:r},g(a,t,e,s,r)};return L.useEffect(()=>{p.medical_checkup_compounds&&d(p.medical_checkup_compounds)},[p]),o("div",{className:"w-full",children:[o("div",{className:`mb-5 text-lg font-semibold ${R} flex justify-between`,children:[i("div",{children:"Obat Racik"}),o(z,{className:"h-8 mr-2 bg-green-500 text-white hover:bg-green-400 hover:text-gray-200 flex items-center",onClick:O,children:[i("div",{className:"mr-2",children:"Tambah Racikan"}),i(T,{})]})]}),f&&f.map((a,t)=>o("div",{children:[o("div",{className:`flex items-center ${t>0?"mt-6":""}`,children:[o("div",{className:"mr-6",children:["Racikan ",t+1]}),i(u,{className:"mr-4",onClick:()=>N(t,a),children:i(T,{})}),i(u,{className:"mr-4",onClick:()=>F(t,a),children:i(S,{className:"text-red-600"})})]}),a.medical_checkup_items&&a.medical_checkup_items.map((e,s)=>o("div",{className:"pl-10 flex justify-start items-baseline mb-3",children:[o("div",{children:[i("span",{className:"text-xs",children:"Obat"}),i(J,{disposable:!0,inStockOnly:!0,itemTypeId:1,currentItem:e.item,onSelect:r=>{h(t,s,a,e,r)},className:"h-8 w-96 mr-2"}),i("span",{className:`text-xs ${e.id==0?"text-red-600":""}`,children:e.id==0?"belum disimpan":""})]}),o("div",{className:"ml-10",children:[i("span",{className:"text-xs",children:"Jumlah"}),i(x,{id:"name",type:"number",name:"name",value:e.quantity,className:" mt-1 block h-8 w-24",onChange:r=>h(t,s,a,{...e,quantity:r.target.value},e.item)})]}),o("div",{className:"ml-10",children:[i("span",{className:"text-xs",children:"Signa"}),i(x,{id:"name",type:"text",name:"name",value:e.signa,className:"mt-1 block h-8",onChange:r=>h(t,s,a,{...e,signa:r.target.value},e.item)})]}),o("div",{className:"ml-10",children:[i("span",{className:"text-xs",children:"Catatan"}),i(x,{id:"name",type:"text",name:"name",value:e.note,className:"mt-1 block h-8",onChange:r=>h(t,s,a,{...e,note:r.target.value},e.item)})]}),o("div",{className:"ml-10 flex items-end mt-auto",children:[i(u,{className:"flex mr-4 ",onClick:()=>P(t,s,a,e),children:i(D,{className:"text-green-600"})}),i(u,{className:"mr-4",onClick:()=>N(t,a),children:i(S,{className:"text-red-600"})})]})]}))]}))]})}export{Re as default};
